# 更新日志


<details>
<summary>v1.51 （2024-12-14）</summary>

**新增**：

- `系统_防火墙规则_添加()` 在系统防火墙中添加新的入站或出站防火墙规则。
- `系统_防火墙规则_删除()` 在系统防火墙中删除防火墙规则。

**优化**：

- `zyJson` 模块更新到 4.1.1

**修复**：

- `雷神lsconsole操作.发送文本U()` 发送的 `Unicode文本` 为问号的问题。

</details>

<details>

<summary>更多日志</summary>

<details>
<summary>v1.50 （2024-10-11）</summary>

**新增**：

- `三个操作类.数据库操作()` 操作模拟器中的sqlite3数据库
- `三个操作类.数据库_枚举表()` 枚举指定的sqlite3数据库中所有表名
- `三个操作类.数据库_查询表()` 查询指定数据表，返回所有数据。
- `三个操作类.创建符号链接()` 为一个文件或者目录创建一个虚拟的符号链接(软链接、symlink)。

**优化**：

- `取DOS返回()`、`取DOS返回_字节集()` 增加可选参数【错误内容】。
  - 如果此参数留空，当命令执行错误时，错误信息直接通过返回值返回。
  - 如果此参数不为空，当命令执行错误时，返回值将会是空文本，错误信息将存在到此变量中。
- `三个操作类.取外网IP()` 更新api地址。
- `地图_位置到经纬度()` 更名为：`地图_地区搜索()`，并且修复可用
- `地图_位置到经纬度1()` 更名为：`地图_位置到经纬度()`

**修复**：

- 修复 上一个版本中 `模拟器操作类` 无法正常执行的问题。

</details>

<details>
<summary>v1.49 （2024-10-09）</summary>

**优化**

- `取DOS返回()`、`取DOS返回_字节集()` 增加可选参数【错误内容】。
  - 如果此参数留空，当命令执行错误时，错误信息直接通过返回值返回。
  - 如果此参数不为空，当命令执行错误时，返回值将会是空文本，错误信息将存在到此变量中。
- `三个操作类.取外网IP()` 更新api地址。
- `地图_位置到经纬度()` 更名为：`地图_地区搜索()`，并且修复可用
- `地图_位置到经纬度1()` 更名为：`地图_位置到经纬度()`

**修复**

- 修复上一个版本中 `模拟器操作类` 无法正常执行的问题。

</details>

<details>
<summary>v1.48 （2024-10-07）</summary>

**新增**

- `MuMU管理器.新建()` 增加参数【迷你磁盘】，可以选择是否创建为迷你磁盘模式。
  - 配置信息、配置属性等相关操作，同步增加有关【迷你磁盘】的操作。

**优化**

- `zyJson` 模块更新到 4.1.0
- `MuMU管理器.取信息()` 优化代码。

**修复**

- 修复 结束端口进程时，导致软件崩溃的问题。

</details>

<details>
<summary>v1.47 （2024-09-01）</summary>

**新增**

- `MuMU管理器.取信息EX_单项()` 根据参数中的匹配规则，返回第一个匹配的模拟器信息。

**优化**
**修复**

- 修复 `雷神_取当前版本()` 无法获取模拟器名称的问题。

</details>

<details>
<summary>v1.46 （2024-08-25）</summary>

**新增**

- `MuMU管理器.取信息_单项()` 快速获取模拟器的单项信息(info)字段值，成功返回获取到的值文本，失败返回空文本。
- `MuMU管理器.点击()` 点击模拟器屏幕。
- `MuMU管理器.滑动()` 滑动模拟器屏幕。如果按下与弹起坐标相同，可以作为长按使用。
- `MuMU管理器.输入()` 向模拟器输入文本。
- `MuMU管理器.输入_U()` 向模拟器输入Unicode编码文本。

**优化**
**修复**

</details>

<details>
<summary>v1.45 （2024-08-20）</summary>

**新增**

- `三个操作类.取系统语言()` 获取安卓当前系统语言设置。
- `三个操作类.置系统语言()` 更改安卓系统语言设置。
- `三个操作类.快速重启()` 不会重启整个系统，只会应用系统属性更改，并刷新应用程序环境。

**优化**

- `MuMU管理器：取信息()`、`取信息EX()` 增加可选参数【重新排序】0=不排序；1=索引升序；2=索引降序；3=标题升序；4=标题降序

**修复**

</details>

<details>
<summary>v1.44 （2024-08-03）</summary>

**新增**

- `MuMU管理器.取配置_单项()` 获取模拟器的单项配置的选项值，成功返回获取到的选项值文本，失败返回空文本。
- `MuMU管理器.置配置_单项()` 修改模拟器的单项配置的选项值，修改前请确保该配置是允许写入的。
- `MuMU管理器.取分辨率模式()` 获取模拟器分辨率模式。返回值例如：“phone.0”=手机第1项，“tablet.1”=平板第2项，“custom”=自定义
- `MuMU管理器.置分辨率模式()` 设置模拟器分辨率模式。
- `MuMU管理器.取分辨率()` 获取模拟器屏幕分辨率（屏幕宽度、屏幕高度、屏幕密度）。
- `MuMU管理器.置分辨率()` 设置模拟器屏幕分辨率（屏幕宽度、屏幕高度、屏幕密度）。
- `MuMU管理器.取GPU类型()` 获取模拟器的GPU类型。返回：low=低配，middle=中配，high=高配，custom=自定义
- `MuMU管理器.置GPU类型()` 设置模拟器的GPU类型。
- `MuMU管理器.取GPU型号()` 获取模拟器的GPU型号。
- `MuMU管理器.置GPU型号()` 设置模拟器的GPU型号。
- `MuMU管理器.取性能策略()` 获取模拟器的性能策略。返回：low=低配，middle=中配，high=高配，custom=自定义
- `MuMU管理器.置性能策略()` 设置模拟器的性能策略。
- `MuMU管理器.取性能()` 获取模拟器的性能参数（包含CPU数量，内存大小）。
- `MuMU管理器.置性能()` 设置模拟器屏幕的性能参数（包含CPU数量，内存大小）。
- `MuMU管理器.取性能预设()` 获取可设置的性能默认参数值（CPU上限、内存上限、推荐CPU数量、推荐内存大小）。

**优化**

- `雷神adb操作.文件_是否存在_模拟器()` 优化判断逻辑。

**修复**

- 修复 `雷神adb操作.重载文件系统()` 无法成功重载MuMu模拟器的问题。
- 修复 `雷神adb操作.枚举目录文件()` 无法枚举包含特殊字符的目录文件的问题。

</details>

<details>
<summary>v1.43 （2024-07-30）</summary>

**新增**

- 新增 44个常量：#配置名_* 方便大家快速操作MuMu模拟器的配置项。
**优化**
- 数据类型：配置信息，添加成员：“备注”。
- 数据类型：配置信息、配置属性 现在“备注”文本由英文改为中文。
**修复**
**优化**

</details>

<details>
<summary>v1.42.0.1 （2024-07-29）</summary>

**修复**

- 修复 `MuMu管理器 取信息()`、`取信息EX()` 无法获取到“主窗口句柄”、“渲染窗口句柄”的问题。
**优化**
**修复**

</details>

<details>
<summary>v1.42 （2024-07-29）</summary>

**新增**

- 配置信息，包含了2个成员：“配置名”、“选项值”。
- 配置属性，包含了5个成员：“配置名”、“备注”、“选项值”、“可读”、“可写”。
- 取所有配置文本() 获取模拟器的所有配置信息，返回配置信息的json文本。
- 取所有配置() 获取模拟器的所有配置信息，返回结果的数量与配置信息。
- 取配置文本() 获取模拟器的指定的配置信息，返回配置信息的json文本。
- 取配置() 获取模拟器的指定的配置信息，返回获取到的配置数量与配置信息。
- 取配置属性文本() 获获取模拟器的指定的配置的值，返回配置属性的json文本。
- 取配置属性() 获取模拟器的指定的配置属性，返回获取到的配置数量与配置属性。
- 置配置() 修改模拟器的指定的配置的选项值，修改前请确保该配置是允许写入的。
- 置配置文件() 根据配置文件（JSON文件）内容修改配置信息。
- 文本到配置属性() 将json文本转换为配置属性，转换成功返回配置数量。
- 文本到配置信息() 将json文本转换为配置信息，转换成功返回配置数量。

**移除**

- 移除了 MuMu管理器 类中，关于旧版api的一系列子程序，如果你使用的MuMu模拟器版本低于4.0，请勿更新。

</details>

<details>
<summary>v1.41.1 （2024-07-28）</summary>

**新增**

- `雷神adb操作.发送文本U()` MuMu模拟器可以用这个命令发送Unicode文本

**优化**

- 增加部分MuMu相关常量：#信息字段_*、#工具栏_*、#快捷_*、#机型_*
- `MuMU管理器：取信息()`、`取信息EX()` 优化查询代码

**修复**

- 修复 `MuMU管理器：取信息()`、`取信息EX()` 当查询结果只有一个模拟器时，无法正确获取到模拟器信息的问题。

</details>

<details>
<summary>v1.41 （2024-07-28）</summary>

- 重要更新：
  - MuMu模拟器重大更新，重新设计了大量API，所以模块也同步进行了大量更新。
  - 本次更新中，类模块“MuMU管理器”几乎全部重新编写，加入了所有官方公布的API，旧代码已做屏蔽，之后的版本中可能会删除。
  - 由于代码改动较多，建议查看模拟器官方文档：[MuMu模拟器官方文档](https://mumu.163.com/help/20240726/35047_1170006.html)

</details>

<details>
<summary>v1.40 （2024-06-29）</summary>

**新增**

- 优化 `雷神adb操作.安装sunny证书()` 支持 MuMu模拟器

**修复**

- 修复 `三个操作类.安装sunny证书()` 雷电模拟器4—32位 新建的模拟器无法成功安装的问题。
- 修复 `三个操作类.文件_是否存在_模拟器()` 模拟器未运行时，会返回真的问题。
- 修复 因目录转换问题，导致 MuMu模拟器 执行部分文件操作函数会失败的问题。

</details>

<details>
<summary>v1.39 （2024-06-27）</summary>

**新增**

- `三个操作类.判断安卓版本()` 判断模拟器的安卓版本

**优化**

- 内部函数：“数组_取差值()” 兼容低版本易语言，不再提示：不能将“文本型 数组”数据转换到“通用型”数据。

**修复**

- 修复 `三个操作类.安装sunny证书()` 雷电模拟器4无法成功安装的问题。

</details>

<details>
<summary>v1.38 （2024-03-15）</summary>

**新增**

- `地图_IP到经纬度()` 通过IP查询地理位置。
- `雷神lsconsole操作.取全部模拟器信息()` 根据指定的条件，返回要获取的模拟器信息数组。成功返回找到的数量，失败返回-1。
- `雷神lsconsole操作、雷神adb操作 中：自定义服务_停止()` 、`CE服务端_停止()` 用来停止启动后的服务。

**优化**

- `三个操作类.取外网IP()` 修复部分无法访问的接口，并增加了几个获取IP的接口。
- `雷神lsconsole操作、雷神adb操作 中：CE服务端_启动()` 、`自定义服务_启动()` 修改返回值为进程ID[整数型]，可配合对应的停止命令。

**修复**

- 修复 `雷神lsconsole操作.新建模拟器()`、`雷神lsconsole操作.克隆模拟器()` 当新模拟器不是最后一个模拟器时，无法正确的返回索引的问题。
- 修复 `雷神lsconsole操作.上传文件()`、`雷神lsconsole操作.下载文件()` 无法正常执行的问题。

</details>

<details>
<summary>v1.37 （2024-03-02）</summary>

**修复**

- 修复 `雷神lsconsole操作.取模拟器信息()` 中一个可能出现数组越界的错误。
- 修复 `雷神adb操作.置文件权限()` 无法成功修改权限的问题。
**优化**
- 优化 模块内部的文本处理函数。

</details>

<details>
<summary>v1.36 （2024-02-18）</summary>

**移除**

- 移除 `启动自定义服务()` 将这个命令拆分成了安装和启动两个命令，详情请查看新增内容。

**新增**

- `自定义服务_安装()` 将自定义服务安装到模拟器中，例如Cheat Engine、IDA的服务端等等。
- `自定义服务_启动()` 启动自定义服务，例如Cheat Engine、IDA的服务端等等。
- `CE服务端_安装()` 安装CE服务端（Cheat Engine Server），用于Cheat Engine通过网络连接到模拟器。
- `CE服务端_启动()` 启动CE服务端（Cheat Engine Server），用于Cheat Engine通过网络连接到模拟器。模拟器需要使用桥接网络，并且开启root。

**修复**

- 修复 `M_取窗口句柄()` 可能获取到非指定索引模拟器的句柄的问题。

</details>

<details>
<summary>v1.35 （2023-12-22）</summary>

**新增**

- `M_取运行中()` 取出当前正在运行的模拟器索引数组，返回运行的模拟器数量。
- `M_取虚拟机进程ID()` 取出指定模拟器的虚拟机进程（MuMuVMMHeadless.exe）的进程ID。成功返回进程ID，失败返回0。
- `雷电_取版本历史()` 查询指定版本的雷电模拟器的版本历史，返回内容为json格式的文本。
- `雷电_取最新版本()` 取出雷神官网中发布的最新版本信息。

**修复**

- 修复 `M_取窗口句柄()` 当索引为0时，有概率无法成功获取到句柄的问题。
- 修复 `MuMu管理器：置分辨率()`、`置性能配置()` 无法成功设置的问题。

</details>

<details>
<summary>v1.34 （2023-11-25）</summary>

**新增**

- MuMu管理器：封装了一些新函数，由于函数较多，这里就不一一列举了，有兴趣的自行查看。

</details>

<details>
<summary>v1.33 （2023-11-20）</summary>

**修复**

- 修复 `三个操作类：通知栏_枚举消息()` 部分消息无法获取标题与内容的问题。

**优化**

- `雷神lsconsole操作：取全部模拟器()` 取全部模拟器EX() 可以通过参数对返回结果进行过滤，详情请查阅源码备注。
- 优化 移除三个操作类中的正则表达式类的调用。对于com组件的效率和稳定性始终不太满意。

</details>

<details>
<summary>v1.32 （2023-10-25）</summary>

**新增**

- `雷神_System是否可写()` 检查模拟器的System.vmdk是否允许写入。
- `雷神_System可写()` 设置模拟器的System.vmdk是否允许写入。必须在模拟器未运行时执行，才可以生效。
- `生成_通讯录文本()` 生成一段简单的通讯录文本，每次生成的内容不同。

**修复**

- 修复 `核心库命令“寻找文本()”` 中的BUG

**优化**

- 优化 模块内部的编码与进制转换。

**移除**

- 移除 模块内使用正则表达式时的自动初始化COM库，当需要在线程中调用时，需自行初始化COM库。

</details>

<details>
<summary>v1.31 （2023-10-16）</summary>

**修复**

- 修复 `雷神_结束端口进程()` 无法忽略部分版本模拟器的虚拟机进程的问题。

**优化**

- 优化 `上传文件()` 优化内部逻辑，参数支持文件名或者目录名。

</details>

<details>
<summary>v1.30 （2023-08-29）</summary>

**新增**

- `三个操作类：是否root()` 检测模拟器是否已经root。
- `三个操作类：安装sunny证书()` 安装sunny中间件的cer证书。安装前请开启模拟器设置中的“root权限”，雷电9还需要设置“System.vmdk可写入”。

</details>

<details>
<summary>v1.29 （2023-08-19）</summary>

**新增**

- `雷神_调整窗口()` 实时修改模拟器窗口位置和大小。
- `三个操作类：枚举权限()`、`枚举权限组()`、`应用授权()`、`应用撤消授权()`。

**修复**

- 修复 `三个操作类：下载网络文件()` 无法正常下载的问题。

**优化**

- 优化 `类_高性能读写锁` 更新到 v2.5.1。
- 优化 `zyJson` 更新到 v4.0.8。

</details>

<details>
<summary>v1.28 （2023-06-29）</summary>

**修复**

- 修复 `雷神adb操作.取连接端口()` 当模拟器为远程端口时，返回文本依然是本地端口的问题。
- 修复 `类_匿名管道` 无法正确运行的问题。

</details>

<details>
<summary>v1.27 （2023-06-23）</summary>

**新增**

- `雷神adb操作：“取远程端口()”`、`“取本地端口()”` 只是简单的计算出端口号，不保证有效性

**优化**

- `雷神_取安装目录()` 支持 雷电模拟器9海外版
- 公开内部类模块: `[类_高性能读写锁]`、`[类_匿名管道]`
- `雷神lsconsole操作：新建模拟器()`、`克隆模拟器()` 雷电模拟器也支持返回索引。
- `雷神adb操作.取连接端口()` 优化连接逻辑，当本地连接失败时，会主动尝试远程连接。
- `雷神adb操作.是否已连接()` 优化判断机制，可以判断本地端口和远程端口。

</details>

<details>
<summary>v1.26 （2023-05-20）</summary>

- 新增 类模块：`MuMu管理器`
  - 本类仅支持 【MuMu模拟器安卓12】版本：3.3.7（包含）以上的版本，其他版本请勿使用。
  - 支持一些模拟器基本操作，执行adb命令，还是推荐使用“雷神adb操作”。

**修复**

- 修复部分已知错误（具体是啥我也忘了。。）

**优化**

- 优化 小幅提升 `取DOS返回` 的效率。

</details>

<details>
<summary>v1.25 （2023-04-15）</summary>

**新增**

- 新增 200多个安卓键代码常量。常量名以“安卓键_”开头

**修复**

- 修复 `三个操作类.枚举安卓控件()` 无法正常工作的问题。

**优化**

- 优化 `三个操作类：取屏幕控件()` 提高效率
- 优化 `三个操作类：枚举安卓控件()` 、`寻找安卓控件（）` 内部正则表达式，提高准确率。
  - （模块中采用正则的方式解析XML，是不愿模块过于臃肿，准确度与执行效率都比较低，如有更高需求的话，可选用其他方式解析XML，也可以参考例程中的解析方式。）
- 优化 `三个操作类.复制文件()` 增加了一个可选参数[附加参数]
  - 可以附加一些cp命令的额外参数。比如：“-f”强行复制文件或目录，不论目的文件或目录是否已经存在；“-r”递归处理，将指定目录下的文件与子目录一并处理。若源文件或目录的形态，不属于目录或符号链接，则一律视为普通文件处理；也可以是一个多参数组合，比如“-f -r”。

</details>

<details>
<summary>v1.24 （2023-03-28）</summary>

**修复**

- 修复 部分用户因为无法成功的将模拟器安装目录转换为短文件名时，导致模块无法正常工作的问题。
- 修复 `三个操作类.取IP()` 在雷电模拟器9中，无法成功获取的问题。
- 修复 `雷神lsconsole操作.取全部模拟器()` 取出单个的模拟器数据中的正则表达式错误。

**优化**

- 优化 `[雷神adb操作|雷神lsconsole操作].下载文件()`
  - 下载文件时，参数[保存到电脑文件]可以包含文件名，下载后自动改名为指定文件名。
  - 下载目录时，参数[待下载的模拟器文件]不再强制要求以"/."结尾。

</details>

<details>
<summary>v1.23 （2023-03-23）</summary>

**新增**
**修复**

- 修复 `雷神adb操作.枚举目录文件()` 当模拟器为“MuMu模拟器”时，文件属性解析错乱的问题。
**优化**
- 优化 `雷神adb操作` 当模拟器为“MuMu模拟器”时，不再通过“MuMuManager.exe”进行命令转发，而是直接执行“adb.exe”。
- 优化 模块附带例程 设置自定义adb之后，文件管理部分可用于“MuMu模拟器”。同时完善了文件管理部分的文件下载的代码演示。

</details>

<details>
<summary>v1.22 （2023-03-23）</summary>

**新增**
**修复**

- 修复 `adb.枚举设备()` 上一个版本中，索引为空时，无法正常工作的问题。
**优化**
- `三个操作类.写出文本文件()` 改名为：`三个操作类.写文本()`
- `三个操作类.查看文件内容()` 改名为：`三个操作类.读文本()`

</details>

<details>
<summary>v1.21 （2023-03-22）</summary>

**新增**

- `三个操作类.取应用版本()`
- 初步兼容 “MuMu模拟器12” 的adb连接，只是做了简单的兼容，因为内部结构与雷电模拟器差异较大，可能会有部分命令无法正常工作。只兼容“MuMu模拟器12”，不支持“MuMu模拟器6”与“MuMu模拟器X”

**修复**

- 修复 `雷神_取APK信息()` 因为编码错误而导致无法成功获取的问题。
- 修复 `取DOS返回()` 一个可能导致返回文本不完整的问题。

**优化**

- 优化 `三个操作类.取外网IP()` 修复部分无法访问的接口，并增加了几个获取IP的接口。
- 优化 `雷神lsconsole操作、雷神adb操作 中：CE服务端_启动()` 、`自定义服务_启动()` 修改返回值为进程ID[整数型]，可配合对应的停止命令。

</details>

<details>
<summary>v1.20 （2023-03-11）</summary>

**新增**

- `三个操作类中：通知栏_展开()`、`通知栏_收起()`、`通知栏_清除消息()`、`通知栏_枚举消息()`

**修复**

- 修复 `取DOS返回()` 取DOS返回_字节集() 当[命令行文本]中包含路径时，提示“目录名称无效”的问题。
- 修复 `雷神lsconsole操作.启动模拟器()` 参数[应用包名]对雷电模拟器不生效的问题。

**优化**

- 优化 `三个操作类中.查找文件()` 增加更多可选参数，原来返回的[安卓文件属性]数组，更改为只返回包含文件名的[文本型]数组
- 优化 `雷神_启动模拟器()` 增加参数[应用包名]
- 优化 `zyJson模块` 更新到v4.0.6

</details>

<details>
<summary>v1.19 （2023-03-02）</summary>

**修复**

- 修复 `三个操作类中：文件_是否存在_模拟器()`、`写出文本文件()`、`取分辨率()`、`取DPI()` 修复BUG
- 修复 `雷神lsconsole操作.发送文本U()` 发送Unicode文本变成问号的问题。

**优化**

- 优化 `取DOS返回()`、`取DOS返回_字节集()` 优化逻辑
- 优化 `三个操作类中：自定义系列的函数`，优化逻辑，并新增参数[超时时间]

</details>

<details>
<summary>v1.18 （2023-02-25）</summary>

**修复**

- 修复 `三个操作类中.取进程ID()` 无法成功获取的问题。
- 修复 `三个操作类中.取进程列表()` 无法成功获取的问题。
- 修复 `三个操作类中.文件_是否存在_模拟器()` 无法成功获取“/data/”目录读取权限的问题。

**优化**

- 优化 `zyJson模块` 更新到v4.0.4

</details>

<details>
<summary>v1.17 （2023-02-23）</summary>

**新增**

- `雷神lsconsole操作.取全部模拟器_json()` 返回全部模拟器的json文本信息。
- `三个操作类中.取系统类型()` 返回当前的安卓系统类型，比如：“64”
- `三个操作类中.自定义命令_管理员()` 以管理员权限执行shell命令，支持批量执行多条shell语句

**优化**

- 优化 `zyJson模块` 更新到v4.0.2
- 优化 `程序_加速优化()` 更新到v1.7.1
- 优化 大部分文件读写类型的函数，无需重载文件系统，可以直接对雷电9中的data目录进行操作。
  - 上传文件() 暂未处理。如果不想重载文件系统，可选方案，先上传至模拟器的其他目录中，然后再复制到data目录里。
  - 下载文件() 暂未处理。如果不想重载文件系统，可选方案，先复制到模拟器的其他目录中，然后再下载到电脑里。

</details>

<details>
<summary>v1.16 （2023-01-05）</summary>

**新增**

- `编码_DOS转义()` 将一段文本转义为DOS可识别文本。
- `解码_DOS转义()` 将一段DOS可识别文本还原到原文。

**修复**

- 修复 `雷神lsconsole操作.取全部模拟器()` 修复参数[索引]并非是按索引，而是按序号获取的问题。
- 修复 `三个操作类中.寻找安卓控件()` 少数控件无法找到的问题。
- 修复 `雷神adb操作.写出文本文件()` 无法正常写出的问题。
- 修复 `雷神adb操作.强制释放端口()` 可能出现数组越界的问题。

</details>

<details>
<summary>v1.15 （2022-09-16）</summary>

**移除**

- 移除 `三个操作类中.取当前包名()`
- 移除 `三个操作类中.取当前应用包名类名()`

**新增**

- `三个操作类中.取当前应用()` 获取当前焦点的应用包名与类名。
- `三个操作类中.取当前应用列表()` 取出正在运行中的应用数量，以及应用包名和类名。

**修复**

- 修复 `三个操作类.取MAC()` 雷电模拟器9 中无法成功获取的问题。

</details>

<details>
<summary>v1.14.1 （2022-09-03）</summary>

**新增**
**修复**

- 修复 因上一个版本中 `程序_加速优化()` 后无法正常工作的问题
**优化**
- `程序_加速优化()` 增加参数[文本增强]文本相加时，直接通过内存长度直接得知文本长度，而非用算法去扫描\0结束符！
  - 现在这个命令不会在模块初始化时自动调用了，大家可以在代码中任何位置自行调用。

</details>

<details>
<summary>v1.14 （2022-09-02）</summary>

**新增**

- `雷神adb操作.停止服务()` 停止指定的服务。
- `雷神adb操作.启动服务()` 启动指定的服务。
  - 上面两个命令其实就是将 `重启adb服务()` 拆分成两个命令，以便于我们在启动服务前进行一些其他操作。
- `雷神adb操作.强制释放端口()` 强制结束指定模拟器所使用的TCP端口进程，可以解决一些因为adb端口被占用，而导致无法连接的问题。
- `程序_加速优化()` 大幅提高代码执行效率。

**修复**

- 修复 `雷神lsconsole操作.取模拟器信息EX2()`，在雷电模拟器中使用此命令会获取失败的问题。

**优化**

- 优化 `雷神lsconsole操作.取全部模拟器()`，命令中的[索引]参数，现在雷神、雷电模拟器都有效（原先只对雷神有效）。

</details>

<details>
<summary>v1.13 （2022-08-06）</summary>

**新增**

- 提供支持 雷电模拟器9

**优化**

- `三个操作类中“getprop”` 改为中文函数 `查看系统信息`
- `三个操作类中“setprop”` 改为中文函数 `设置系统信息`
- `zyJson模块` 更新到3.2.8

</details>

<details>
<summary>v1.12 （2022-07-04）</summary>

**新增**

- `三个操作类.取系统时间()`，获取模拟器的系统时间；
- `三个操作类.置系统时间()`，设置模拟器的系统时间；
- `雷神_结束进程()`，结束所有模拟器前台与后台相关进程；
- `雷神_安装虚拟机()`，修复安装模拟器的VirtualBox内核组件；

**修复**

- 修复 `托盘_刷新()`，修复部分系统无法清除托盘图标的问题；

**优化**

- 优化 `雷电_关闭广告()`，同时会删除开机启动的弹出广告。
- 优化 `雷神_取安装目录()`，当获取失败时，调试信息中会显示获取失败的对应版本名称。

</details>

<details>
<summary>v1.11 （2022-06-23）</summary>

**新增**

- `雷神lsconsole操作.发送文本U()`，向指定的模拟器发送Unicode文本，支持韩文、日文、Emoji表情等特殊字符。

**修复**
**优化**

- 优化 `雷神adb操作.取连接端口()`，优化了获取规则。
- 优化 `雷神adb操作.启动自定义服务()`，上传单文件改为上传目录中所有文件。
- 优化 `zyJson模块` 更新到3.2.6

</details>

<details>
<summary>v1.10 （2022-04-21）</summary>

**新增**

- `三个操作类.开关位置信息()`，开启或者关闭模拟器的位置信息(GPS定位)。
- `三个操作类.查询wifi状态()`，查询当前模拟器的wifi状态，返回查询结果。
- `三个操作类.重载文件系统()`，重新挂载安卓文件系统。默认情况下，安卓部分系统目录是只读模式，如果你需要对这些目录进行改写操作，必须先重载文件系统。

**修复**
**优化**

- 修复 `雷神lsconsole操作.取模拟器信息()`，当参数[结果类型]=-1时，无法获取信息的问题。

</details>

<details>
<summary>v1.9 （2022-04-08）</summary>

**新增**
**修复**

- 修复 `三个操作类.应用是否启动()`，在某些场景判断不准确的问题。
- 修复 `雷神adb操作.上传文件()`，会自动修正目录参数，避免因参数错误而无法上传。
**优化**
- 优化 `三个操作类.启动应用()`，参数[应用类名]留空时，为启动主界面。
- 优化 `雷神_取安装目录()`，现在可以获取到“雷电模拟器繁体版”的安装目录。详情见模块中的参数说明。
- 优化 `雷神_按键设置()`，当对应的配置文件不存在时，现在会根据参数新建一份按键设置并保存。

</details>

<details>
<summary>v1.8 （2022-03-24）</summary>

**新增**
**修复**

- 修复 当易语言系统配置中，启用了严格检查参数时，编译报错的问题。
- 修复 `雷神adb操作.上传文件()`，当上传文件为目录时，会提示文件不存在的问题。
- 修复 `雷神_置注册表()`，当注册项中不存在时，无法成功写入的问题。
**优化**
- 优化 `雷神_取安装目录()`，优化了桌面快捷方式的获取逻辑，更容易获取到安装目录；增加参数“自动写入注册表”，当成功从桌面快捷方式中发现安装目录时，自动将此目录的模拟器信息写入到注册表中。

</details>

<details>
<summary>v1.7 （2022-01-23）</summary>

**修复**

- 修复 `雷神lsconsole操作.取模拟器信息()`，当参数“条件类型”为-1时，无法返回正确的结果的问题。
- 修复 `雷神ls操作.自定义命令()`，参数“序号”未生效的问题。

</details>

<details>
<summary>v1.6 （2022-01-20）</summary>

**修复**

- 修复 `雷神_置注册表()`，移除了内部一个调用核心库5.81的命令，避免因易语言版本太低而无法使用模块的问题。
- 修复 `雷神adb操作.应用是否启动()`，当adb异常出错时，也会返回为真的问题。
**优化**
- 优化 `三个操作类的基础运行模式`，现在模块不会再修改代码中的当前目录。

</details>

<details>
<summary>v1.5 （2022-01-10）</summary>

**新增**

- `雷神_按键设置()`，修改指定应用的全局按键设置。在启动应用之前执行一次，即可对全部模拟器生效。
**修复**
- 修复 `雷神lsconsole操作类` 中几处可能导致数组下标错误的问题。
**优化**
- 优化 `雷神_置安装目录()`，执行后，其他操作类中的模拟器目录都会同步为此目录。

</details>

<details>
<summary>v1.4 （2021-12-09）</summary>

**新增**

- `雷神_取定位信息()`，取出模拟器配置中的定位信息
- `三个操作类.取当前包名()`，取出当前前台运行的应用包名
**修复**
**优化**
- 修复 `lsconsole.置摄像头图片()`，错误的将雷神判断为雷电，而提示版本过低的问题；
- 修复 `雷神_取安装目录_全部()`，因为上一个版本中修改了取注册表部分的代码，而导致此命令失败的问题。

</details>

<details>
<summary>v1.3 （2021-11-17）</summary>

**新增**

- `托盘_刷新()`，用来清理意外关闭的模拟器所残留的托盘图标；
- `雷神_取注册表()`，获取指定版本的模拟器在注册表中的信息；
- `雷神_置注册表()`，修改指定版本的模拟器在注册表中的信息；
**修复**
- 修复 `adb.重启adb服务()`，有几率遇到之前连接正常的模拟器，重启后反而无法连接的问题。
**优化**
- 修改 `雷神_取安装目录()`，移除了内部的写注册表操作；
- 修改 `雷神_置安装目录()`，增加参数“写到注册表”，为真时，会同时将“安装目录”写入到注册表；
- 修改 `三个操作类.查找文件()`，现在可以根据文件权限、文件大小、创建时间、修改时间、访问时间来查找文件。

</details>

<details>
<summary>v1.2 （2021-11-13）</summary>

**修复**

- 修复上一个版本中“雷神_取当前版本()”无法正确获取模拟器版本号，而出现的诸多问题。
**优化**
- 优化 “三个操作类中的：枚举安卓控件()”，“寻找安卓控件()”，增加参数：“屏幕控件”，用来手动选择屏幕控件xml文本进行解析，如果本参数留空，则自动执行“取屏幕控件”获取xml。同时也更新了例程中的控件部分演示代码。

</details>

<details>
<summary>v1.1 （2021-11-08）</summary>

**新增**

- “三个操作类.枚举安卓控件()”，取出模拟器屏幕上的全部安卓控件，返回 控件数量 与 枚举结果数组；
- “三个操作类.寻找安卓控件()”，按条件对模拟器屏幕上的控件进行查找，返回匹配的数量与控件信息；
- “雷神_取运行中模拟器目录()”，获取当前运行中的模拟器目录；

</details>

<details>
<summary>v1.0.1.5 （2021-10-18）</summary>

**新增**

- “三个操作类.查看系统属性()”，查看系统设置。
- “三个操作类.设置系统属性()”，修改系统设置。注意，修改系统属性有一定风险，设置错误可能导致模拟器出现异常问题。
- “三个操作类.删除系统属性()”，删除系统设置。注意，修改系统属性有一定风险，设置错误可能导致模拟器出现异常问题。
- “三个操作类.取WIFI名称()”，取出模拟器中的WIFI连接的的SSID。
- “三个操作类.设置代理()”，设置模拟器的wifi代理。设置完成后，可以用“取当前代理()”查看结果。
- “三个操作类.移除代理()”，删除模拟器的wifi代理设置。注意：移除代理后要重启模拟器才能生效。
- “三个操作类.取当前代理()”，取出当前代理IP信息。
- “三个操作类.设置代理1()”，另一种设置代理的方式，此命令需要额外安装apk，具体用法查看命令备注。
- “三个操作类.移除代理1()”，移除模拟器的wifi代理。

</details>

<details>
<summary>v1.0.1.3 （2021-10-11）</summary>

**修复**

- 修复 sconsole.启动模拟器(), 当超时时间参数为空时，雷神模拟器不会立即返回的问题。
- 修复 类：雷神ls操作，雷神有时候会错误的执行雷电的“ld.exe”的问题。

</details>

<details>
<summary>v1.0.1.2 （2021-09-16）</summary>

**新增**

- 新增 置DOS全局超时(), 设置模块中所有DOS命令的默认超时时间，如果“取DOS返回()”中的“超时时间”参数留空时，则会以此时间作为默认值。
**修复**
- 修复 lsconsole.启动模拟器(), 部分模拟器版本使用，始终立即返回（异步模式）“假”的问题；

</details>

<details>
<summary>v1.0.1.1 （2021-08-02）</summary>

**新增**

- 新增 三个操作类.录制视频(), 录制一段模拟器屏幕视频；
**修复**
- 修复 取DOS返回(), 当提供了“超时时间”，现在会自动结束超时的进程。例如：出现多个adb.exe超时进程；
**优化**
- 优化 取DOS返回_字节集(), 增加参数“是否宽字节”，是否为UNICODE宽字节。

</details>

<details>
<summary>v1.0.1.0 （2021-05-17）</summary>

**新增**

- `三个操作类.取外网IP`，因上一版本中编码处理方式改动，所在省市返回为乱码的问题；
- `adb.重启adb服务()`，可能出现线程阻塞无法返回的问题；
- `lsconsole.取模拟器信息()`，当模拟器标题文本中存在","时，无法正确获取到信息的问题。

**修复**

- 修复 `三个操作类.取外网IP`，因上一版本中编码处理方式改动，所在省市返回为乱码的问题；
- 修复 `adb.重启adb服务()`，可能出现线程阻塞无法返回的问题；
- 修复 `lsconsole.取模拟器信息()`，当模拟器标题文本中存在","时，无法正确获取到信息的问题。

**优化**

- 优化 `三个操作类.取网页源码()`，增加可选参数[超时]单位：秒 默认为15秒；-1为无限等待；

</details>

<details>
<summary>v1.0.0.9 （2021-05-06）</summary>

**新增**

- `adb.置连接端口()`，某些特殊情况下，无法自动获取连接端口时，可以手动设定连接端口。

**修复**

- 修复 `三个操作类.取屏幕控件()`，连续获取时，返回的内容有可能依然是上一次内容的问题。
- 修复 `adb.截屏_字节集()`，修复了雷电3.0版本无法成功截屏的问题。

**优化**

- 优化 `lsconsole.备份模拟器()`，移除参数"超时时间"；增加参数"是否压缩[逻辑型]"，为真时，备份文件会以zip格式进行压缩。留空则不压缩。新参数需要雷神1.0.9以上版本支持。
- 优化 `adb.重启adb服务()`，优化了结束冲突端口部分代码。
- 优化 `adb.取连接端口()`，优化了查询端口的算法，并增加参数“不使用缓存[逻辑型]”，用于某些特殊场景，需要重新获取端口时使用。
- 优化 `三个操作类.取网页源码()`，支持更多可选参数，详情请参阅命令备注。移除自动转码功能，有需要的话，请自行转码。

</details>

<details>
<summary>v1.0.0.8 （2021-04-14）</summary>

**新增**

- `三个操作类.清空通讯录()`，清空模拟器中的通讯录。
- `三个操作类.导入通讯录()`，将通讯录vcf文件导入到模拟器中。
- `三个操作类.枚举输入法()`，枚举出模拟器中全部输入法。
- `三个操作类.取当前输入法()`，获取当前输入法。
- `三个操作类.置当前输入法()`，将指定的输入法设置为当前输入法。

**修复**

- 修复 `雷神adb操作`，重启模拟器后，可能导致获取端口号错误的问题。

**优化**

- 优化 `lsconsole.取全部模拟器EX()`，文本处理改为正则方式，当模拟器数量较多时，效率大幅提升。

</details>

<details>
<summary>v1.0.0.7 （2021-03-27）</summary>

**优化**

- 优化 `lsconsole与adb类.上传文件()`，因目录名不规范而导致上传失败的问题。
- 优化 `lsconsole与adb类.下传文件()`，当下传目标为包含目录，且包含子目录时，下载失败的问题。
- 优化 `三个操作类.取文件权限()`，优化内部逻辑。现在可以同时取出“文件所有者”，“文件用户组”。
- 优化 `三个操作类.置文件权限()`，现在可以同时设置“文件所有者”，“文件用户组”。

</details>

<details>
<summary>v1.0.0.6 （2021-03-21）</summary>

**新增**

- `lsconsole.取模拟器信息EX2()`，根据索引取出模拟器信息，成功返回真，失败返回假。模拟器数量较多时，推荐使用。
- `lsconsole.取模拟器数量()`，返回模拟器总数。
- `adb.启动自定义服务()`，启动各种自定义服务，例如Cheat Engine的ce_server、IDA的android_server等等。

**修复**
**优化**

- 优化 `lsconsole.启动模拟器()`，现在会直到模拟器启动完毕后（成功进入安卓），才返回结果。并增加一个 超时时间 参数。

**移除**

- 移除 `adb.启动CE服务端()`，可用“adb.启动自定义服务()`替代。

</details>

<details>
<summary>v1.0.0.5 （2021-03-04）</summary>

**新增**

- `lsconsole.取模拟器信息EX2()`，根据索引取出模拟器信息，成功返回真，失败返回假。
- `lsconsole.取模拟器数量()`，返回模拟器总数。
- `adb.启动自定义服务()`，启动各种自定义服务。

</details>

<details>
<summary>v1.0.0.4 （2021-03-01）</summary>

**新增**

- `三个操作类.查看内存映射()`，查看指定进程的虚拟地址空间是如何使用的。

**修复**

- 修复 `三个操作类.查看文件内容()`，返回内容将不再进行自动转换编码，以便于更好的判断是否在写入时需要转码。如果遇到中文乱码，请自行转码。

**优化**

- 优化 `雷神_取APK信息()`，当APK为多语言应用时，优先获取中文“应用名称”。现在可以获取到APK的版本信息了。

</details>

<details>
<summary>v1.0.0.3 （2021-02-22）</summary>

**新增**

- `雷神_取APK信息()`，获取电脑中APK文件的详细信息（应用名称，包名，类名）。
- `地图_百度转火星1()`，调用网络API进行坐标系转换。
- `地图_国际转火星1()`，调用网络API进行坐标系转换。
- `地图_地点搜索()`，在指定的范围内进行地点搜索，范围可以为城市、经纬度、指定矩形。
- `adb.启动CE服务端()`，用于Cheat Engine通过网络连接到模拟器。

**修复**

- 修复 `ls.取外网IP()`，部分接口返回的城市信息为问号的问题。
- 修复 `ls.枚举目录文件()`，当目录、文件名为中文时，返回为问号的问题。

</details>

<details>
<summary>v1.0.0.2 （2021-02-05）</summary>

**新增**

- `雷神_启动模拟器()`，启动模拟器的另一种方式。
**修复**
**优化**
- 优化 `雷神_取安装目录()`，支持雷神模拟器64位版本。

</details>
</details>
